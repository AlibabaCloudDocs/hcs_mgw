# 迁移实施 {#concept_qt5_x3l_qfb .concept}

本文介绍数据迁移的注意事项和操作步骤。

## 注意事项 {#section_lfs_tth_yfb .section}

在线迁移需注意以下问题：

-   在线迁移会占用源地址和目的地址的外网带宽。若您的业务比较重要，建议您对迁移任务设置限速，或在空闲时间启动迁移任务。
-   在线迁移前会检查源地址和目的地址的文件，但是若您源和目的有相同文件名的文件，且源地址的文件更新时间比目的地址文件更新时间晚，迁移时会直接覆盖目的地址的文件。若两个文件内容不同，必须更改文件名或做好备份。

## 步骤一：创建源地址 {#procedure_one .section}

1.  登录[阿里云数据在线迁移控制台](https://mgw.console.aliyun.com/#/job?_k=6w2hbo)。
2.  选择**在线迁移服务** \> **数据地址**，然后单击**创建数据地址**。
3.  在创建数据地址页面，配置相关参数，然后单击**确认**。参数说明如下：

    |参数|是否必需|说明|
    |:-|:---|:-|
    |**数据类型**|是|选择**Azure Blob**。|
    |**数据名称**|是|输入 3-63 位字符。不支持短横线（-）和下划线（\_）之外的特殊字符。|
    |**连接字符串**|是|连接字符串为EndpointSuffix后的内容，如`core.chinacloudapi.cn`。您可以在Azure控制台中找到存储账户，单击对应存储账户，选择**设置** \> **访问密钥**，[查看连接字符串](#)。|
    |**容器**|是|Azure空间名称，由blob构成。此处区分大小写，严格按照创建时输入。|
    |**前缀**|是|     -   迁移全部数据：迁移整个容器中的数据。

迁移全部数据时，无需填写前缀。

    -   迁移部分数据：迁移指定目录（前缀）下的文件。格式要求：不能为空；不能以 / 开头，要以 / 结尾，如`data/to/oss`。
 |
    |**存储账户**|是|您可以在Azure控制台中找到存储账户，在存储账户菜单边栏选项卡中选择**设置** \> **访问密钥**，查看存储账户。|
    |**密钥**|是|您可以在Azure控制台中找到存储账户，在存储账户菜单边栏选项卡中选择**设置** \> **访问密钥**，查看访问密钥。|

4.  系统提示该功能在公测中，需要提交白名单权限申请。单击**去申请**。
5.  填写相关信息，提交迁移公测申请。申请通过后，您将收到短信提醒。

## 步骤二：创建目的地址 {#section_std_hkf_qfb .section}

1.  选择**在线迁移服务** \> **数据地址**，然后单击**创建数据地址**。
2.  在创建数据地址页面，配置相关参数，然后单击**下一步**。参数说明如下：

    |参数|是否必需|说明|
    |:-|:---|:-|
    |**数据类型**|是|选择 **OSS**。|
    |**数据所在区域**|是|选择目的地址所在的地域。|
    |**数据名称**|是|输入 3-63 位字符。不支持短横线（-）和下划线（\_）之外的特殊字符。|
    |**OSS Endpoint**|是|根据您数据所在区域，选择一个 Endpoint，详情请参见[访问域名](../../../../cn.zh-CN/开发指南/访问域名和数据中心.md#)。|
    |**AccessKeyId 和 AccessKeySecret**|是|输入用于迁移的AccessKey。详情请参见[创建AccessKey](cn.zh-CN/HTTP__HTTPS 源迁移教程/准备工作.md#ak)。|
    |**OSS Bucket**|是|选择一个存储空间，用于存储迁移数据。|
    |**OSS Prefix**|否|格式要求不能以正斜线（/） 开头，要以正斜线（/） 结尾，如 `data/to/oss/`。如果为空表示迁移至所选存储空间的根目录。|


## 步骤三：创建迁移任务 {#section_ksy_xmy_pfb .section}

1.  选择**在线迁移服务** \> **迁移任务**，然后单击**创建迁移任务**。
2.  在创建迁移任务页面，阅读迁移服务条款协议，勾选**我理解如上条款，并申请开通数据迁移服务**，然后单击**下一步**。
3.  在配置任务页签，设置相关参数，然后单击**下一步**。

    参数说明如下：

    |参数|是否必需|说明|
    |:-|:---|:-|
    |**任务名称**|是|输入 3-63 位小写字母、数字、短横线（-），且不能以短横线（-）开头或结尾。|
    |**源地址**|是|选择已创建的源地址。|
    |**目的地址**|是|选择已创建的目的地址。|
    |**迁移方式**|是|全量迁移和增量迁移均会在每次迁移开始前，对源地址和目的地址的文件进行对比。文件名一致、文件大小相同且目的地址的文件更新时间比源地址文件更新时间晚，文件会在迁移时被跳过，其余文件均会被迁移。    -   **全量迁移**：迁移一次全量数据，数据迁移完成后任务结束。如果之后源数据有变化，您可以再次提交全量迁移任务，系统将仅迁移变化的数据。
    -   **增量迁移**：按设定的迁移间隔和迁移次数执行迁移任务。首次执行全量迁移，之后每个时间间隔结束，执行一次增量迁移，将源地址新增或修改的部分数据迁移至目的地址。每执行一次迁移任务，迁移次数减1。当迁移次数归0时，迁移任务结束。例如：设置迁移间隔1小时，迁移次数5次。则进行1次全量迁移和4次增量迁移，每次迁移间隔1小时。
|
    |**迁移间隔**|是（针对增量迁移）|默认值 1 小时，最大值 24 小时。|
    |**迁移次数**|是（针对增量迁移）|默认值 1 次，最大值 30 次。|

4.  在性能调优页签的**数据预估**区域，填写**迁移存储量**和**迁移文件个数**。

    **说明：** 为了迁移任务的顺利进行，请尽量准确进行数据预估。详情请参见[预估迁移数据](cn.zh-CN/Azure Blob 迁移教程/准备工作.md#ul_srn_mnm_qfb)。

5.  （可选）在性能调优页签的**流量控制**区域，设置**限流时间段**和**最大流量**，然后单击**添加**。

    **说明：** 为了不影响您在线业务的访问，建议您根据业务访问的波峰和波谷来设置迁移时的**限流时间段**和**最大流量**。**限流时间段**的默认值为 06:00 - 12:00。**最大流量**的默认值为 5 MByte/s。

6.  单击**创建**。等待迁移任务完成。

## 附录：查看连接字符串 {#look .section}

查看连接字符串位置可参考下图：![](images/31116_zh-CN_source.png)

